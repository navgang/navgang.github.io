const o={context:void 0,registry:void 0,effects:void 0,done:!1,getContextId(){return D(this.context.count)},getNextContextId(){return D(this.context.count++)}};function D(t){const e=String(t),n=e.length-1;return o.context.id+(n?String.fromCharCode(96+n):"")+e}function w(t){o.context=t}function q(){return{...o.context,id:o.getNextContextId(),count:0}}const tt=!1,et=(t,e)=>t===e,vt=Symbol("solid-proxy"),yt=Symbol("solid-track"),E={equals:et};let H=X;const d=1,A=2,M={owned:null,cleanups:null,context:null,owner:null};var l=null;let L=null,nt=null,i=null,f=null,a=null,$=0;function st(t,e){const n=i,s=l,r=t.length===0,u=e===void 0?s:e,c=r?M:{owned:null,cleanups:null,context:u?u.context:null,owner:u},I=r?t:()=>t(()=>p(()=>C(c)));l=c,i=null;try{return x(I,!0)}finally{i=n,l=s}}function V(t,e){e=e?Object.assign({},E,e):E;const n={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},s=r=>(typeof r=="function"&&(r=r(n.value)),W(n,r));return[Q.bind(n),s]}function rt(t,e,n){const s=R(t,e,!1,d);m(s)}function ut(t,e,n){H=pt;const s=R(t,e,!1,d),r=k&&K(k);r&&(s.suspense=r),s.user=!0,a?a.push(s):m(s)}function h(t,e,n){n=n?Object.assign({},E,n):E;const s=R(t,e,!0,0);return s.observers=null,s.observerSlots=null,s.comparator=n.equals||void 0,m(s),Q.bind(s)}function St(t){return x(t,!1)}function p(t){if(i===null)return t();const e=i;i=null;try{return t()}finally{i=e}}function Ct(t){ut(()=>p(t))}function ot(t){return l===null||(l.cleanups===null?l.cleanups=[t]:l.cleanups.push(t)),t}function mt(){return i}function lt(){return l}function it(t){a.push.apply(a,t),t.length=0}function G(t,e){const n=Symbol("context");return{id:n,Provider:gt(n),defaultValue:t}}function K(t){let e;return l&&l.context&&(e=l.context[t.id])!==void 0?e:t.defaultValue}function ct(t){const e=h(t),n=h(()=>P(e()));return n.toArray=()=>{const s=n();return Array.isArray(s)?s:s!=null?[s]:[]},n}let k;function ft(){return k||(k=G())}function Q(){if(this.sources&&this.state)if(this.state===d)m(this);else{const t=f;f=null,x(()=>O(this),!1),f=t}if(i){const t=this.observers?this.observers.length:0;i.sources?(i.sources.push(this),i.sourceSlots.push(t)):(i.sources=[this],i.sourceSlots=[t]),this.observers?(this.observers.push(i),this.observerSlots.push(i.sources.length-1)):(this.observers=[i],this.observerSlots=[i.sources.length-1])}return this.value}function W(t,e,n){let s=t.value;return(!t.comparator||!t.comparator(s,e))&&(t.value=e,t.observers&&t.observers.length&&x(()=>{for(let r=0;r<t.observers.length;r+=1){const u=t.observers[r],c=L&&L.running;c&&L.disposed.has(u),(c?!u.tState:!u.state)&&(u.pure?f.push(u):a.push(u),u.observers&&Y(u)),c||(u.state=d)}if(f.length>1e6)throw f=[],new Error},!1)),e}function m(t){if(!t.fn)return;C(t);const e=$;at(t,t.value,e)}function at(t,e,n){let s;const r=l,u=i;i=l=t;try{s=t.fn(e)}catch(c){return t.pure&&(t.state=d,t.owned&&t.owned.forEach(C),t.owned=null),t.updatedAt=n+1,_(c)}finally{i=u,l=r}(!t.updatedAt||t.updatedAt<=n)&&(t.updatedAt!=null&&"observers"in t?W(t,s):t.value=s,t.updatedAt=n)}function R(t,e,n,s=d,r){const u={fn:t,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:l,context:l?l.context:null,pure:n};return l===null||l!==M&&(l.owned?l.owned.push(u):l.owned=[u]),u}function F(t){if(t.state===0)return;if(t.state===A)return O(t);if(t.suspense&&p(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<$);)t.state&&e.push(t);for(let n=e.length-1;n>=0;n--)if(t=e[n],t.state===d)m(t);else if(t.state===A){const s=f;f=null,x(()=>O(t,e[0]),!1),f=s}}function x(t,e){if(f)return t();let n=!1;e||(f=[]),a?n=!0:a=[],$++;try{const s=t();return ht(n),s}catch(s){n||(a=null),f=null,_(s)}}function ht(t){if(f&&(X(f),f=null),t)return;const e=a;a=null,e.length&&x(()=>H(e),!1)}function X(t){for(let e=0;e<t.length;e++)F(t[e])}function pt(t){let e,n=0;for(e=0;e<t.length;e++){const s=t[e];s.user?t[n++]=s:F(s)}if(o.context){if(o.count){o.effects||(o.effects=[]),o.effects.push(...t.slice(0,n));return}w()}for(o.effects&&(o.done||!o.count)&&(t=[...o.effects,...t],n+=o.effects.length,delete o.effects),e=0;e<n;e++)F(t[e])}function O(t,e){t.state=0;for(let n=0;n<t.sources.length;n+=1){const s=t.sources[n];if(s.sources){const r=s.state;r===d?s!==e&&(!s.updatedAt||s.updatedAt<$)&&F(s):r===A&&O(s,e)}}}function Y(t){for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e];n.state||(n.state=A,n.pure?f.push(n):a.push(n),n.observers&&Y(n))}}function C(t){let e;if(t.sources)for(;t.sources.length;){const n=t.sources.pop(),s=t.sourceSlots.pop(),r=n.observers;if(r&&r.length){const u=r.pop(),c=n.observerSlots.pop();s<r.length&&(u.sourceSlots[c]=s,r[s]=u,n.observerSlots[s]=c)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)C(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)C(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function dt(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function _(t,e=l){throw dt(t)}function P(t){if(typeof t=="function"&&!t.length)return P(t());if(Array.isArray(t)){const e=[];for(let n=0;n<t.length;n++){const s=P(t[n]);Array.isArray(s)?e.push.apply(e,s):e.push(s)}return e}return t}function gt(t,e){return function(s){let r;return rt(()=>r=p(()=>(l.context={...l.context,[t]:s.value},ct(()=>s.children))),void 0),r}}let z=!1;function Et(){z=!0}function wt(t,e){if(z&&o.context){const n=o.context;w(q());const s=p(()=>t(e||{}));return w(n),s}return p(()=>t(e||{}))}const bt=t=>`Stale read from <${t}>.`;function At(t){const e=t.keyed,n=h(()=>t.when,void 0,void 0),s=e?n:h(n,void 0,{equals:(r,u)=>!r==!u});return h(()=>{const r=s();if(r){const u=t.children;return typeof u=="function"&&u.length>0?p(()=>u(e?r:()=>{if(!p(s))throw bt("Show");return n()})):u}return t.fallback},void 0,void 0)}const xt=G();function kt(t){let e=0,n,s,r,u,c;const[I,T]=V(!1),B=ft(),v={increment:()=>{++e===1&&T(!0)},decrement:()=>{--e===0&&T(!1)},inFallback:I,effects:[],resolved:!1},J=lt();if(o.context&&o.load){const y=o.getContextId();let b=o.load(y);if(b&&(typeof b!="object"||b.s!==1?r=b:o.gather(y)),r&&r!=="$$f"){const[N,S]=V(void 0,{equals:!1});u=N,r.then(()=>{if(o.done)return S();o.gather(y),w(s),S(),w()},U=>{c=U,S()})}}const j=K(xt);j&&(n=j.register(v.inFallback));let g;return ot(()=>g&&g()),wt(B.Provider,{value:v,get children(){return h(()=>{if(c)throw c;if(s=o.context,u)return u(),u=void 0;s&&r==="$$f"&&w();const y=h(()=>t.children);return h(b=>{const N=v.inFallback(),{showContent:S=!0,showFallback:U=!0}=n?n():{};if((!N||r&&r!=="$$f")&&S)return v.resolved=!0,g&&g(),g=s=r=void 0,it(v.effects),y();if(U)return g?b:st(Z=>(g=Z,s&&(w({id:s.id+"F",count:0}),s=void 0),t.fallback),J)})})}})}export{vt as $,At as S,wt as a,St as b,V as c,yt as d,kt as e,rt as f,mt as g,st as h,Et as i,ot as j,Ct as o,o as s,p as u};
